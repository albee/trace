# data/input

This directory contains reference trajectories and other input information for the Chaser and Target.

Contents:

* sample_trajectories - Misc. sample trajectories, including ones used for Target tracking.

* TEST* - Caroline format for hardware testing.

---

## Final DLR input format (traj-gen-dlr-gronud)

The final format is 5 .dat files:
* results_pos_0.dat
* results_vel_0.dat
* results_quat_0.dat
* results_ang_vel_0.dat
* results_input_0.dat

The output of reading in these files (see `dlr_utils.h`) is

output_x = Eigen::MatrixXd(
  t x y z xd yd zd qx qy qz qw wx wy wz xdd ydd zdd wxd wyd wzd
  ...
  )

[row, 20]

output_u = Eigen::MatrixXd(
  t ux uy uz
  ...
  )

[row, 4]

--
## Deprecated: DLR_chaser_LUT_4_20_20

Chaser Lookup Table (LUT) and Normal Target Trajectories

### Usage
Calling `run_view_MIT` will generate a set of .dat files in DATA/ that can be parsed to obtain trajectory setpoints. These .dat files
can be read in and used by the MPC nodelet. Can also be sent out by chaser_coordinator to default controller (TODO).

Note: lib/ contains shared libraries required for the executable to work. You must add these to your $LD_LIBRARY_PATH environment variable
for the executable to work. Roberto will provide a future version of the executable with static libraries.

### Formatting
`LUT_temp.dat`:
[3-1-3 Euler Target orientation (rad) [1:3], Target ang. vel. TARGET frame (deg/s) [4:6], ...
 Chaser goal pos/vel [7:12], Chaser x-setpoints [13:32], Chaser y-setpoints[33:52], Chaser z-setpoints[53:72]]

`Results.dat`:
[time, x, y, z] INERTIAL frame

`Results_vel.dat`:
[time, xd, yd, zd] INERTIAL frame

`Results_acc.dat`:
[time, xdd, ydd, zdd] INERTIAL frame

`Results_jerk.dat`:
[time, xddd, yddd, zddd] INERTIAL frame

### Formatting for Read-In Information (Chaser)
[t x y z xd yd zd qw qx qy qz wx wy wz xdd ydd zdd wxd wyd wzd
...
]

### Formatting for Read-In Information (Target)
(TO DO)

---

## Deprecated: motion_planner_interface_06_26_20

An iteration on the LUT problem that can produce plans in realtime. Will be operated by the motion_planner_interface nodelet. The real export-controlled executable is **NOT** provided in the public repository.

DATA is 3D translational trajectory profile only---attitude information is not yet provided

Input:
* `Param_view_MIT.dat` selects one of many possible trajectory types. 189 has been used frequently for testing.

Output
* Same as `DLR_chaser_LUT_*`

### Usage

Run `run_view_MIT`, which uses the `Param_view_MIT.dat` to produce an output trajectory.

## sample_trajectories (one-off)

These are sample one-off trajectories Roberto and others have provided. The final formatting may change.

`chaser_sample_traj.csv` is a trajectory generated by Alex's AGA at 50 Hz.

`dlr_chaser_traj1.dat` is a sample trajectory provided by Roberto, for the Chaser.

`dlr_target_traj1.dat` is a sample trajectory provided by Roberto, for the Target.

### Usage
These trajectories can be read in by chaser_coordinator or target_coordinator, respectively. `dlr_chaser_traj1.dat` is now currently compatible! See input to `execute_asap.py`.

A few notes:

* A few values should really be parameter inputs to the motion planner. These are: initial condition of Chaser (Target Frame) and initial condition of Target (Inertial Frame)

* Change line 60 of sim_td.launch such that honey launches
 at [10.9, -9.65, 4.9] to account for the 3m offset.

* Chaser does not have attitude data, so it will stay in its initial orientation throughout the flight.

* Target's orientation and angular velocity data don't appear to line up perfectly, so the tumble is somewhat hiccup-y.

* To fix this, comment 360-362...it's a patch fix but it should do for now. Feel free to play around with coordinate transformations, I could be wrong.

### Formatting
`dlr_chaser_traj1.dat`:
Data structure; time, x, y, z

Duration 120 s
Target tumbling state as in previous email
Mating Point in Target body frame at [0.5 0 0] [m]
Position of Target CoM at [3 0 0] [m] - this might be too much?
workspace constraints 4x4x4 [m]
Chaser velocity constraints 0.1x0.1x0.1 [m/s]
Chaser thruster constraints [0.452 0.216 0.257] [N]

`dlr_target_traj1.dat`:
Inertia in ENVISAT body frame: [17023.3 397.1 −2171.4; 397.1 124825.7 344.2; −2171.4 344.2 129112.2] kg m^2.
Initial omega in the ENVISAT body frame omegaBF=(5*pi/180)*[0 1 1]/sqrt(2) rad/s
You will find in attach my simulation of the resulting tumbling motion: time, q_scal, q_vec(1), q_vec(2), q_vec(3), omega_IF(1), omega_IF(2), omega_IF(3), where IF is the inertial frame.
Some information on the trajectory: low-energy case, period=172.2s.
I assumed a zero initial orientation for simplicity. We could however talk about the way in which we want to define these trajectories next (and for the experiments), e.g., if we prefer to have the angular momentum vector aligned with the inertial z_axis; if you prefer me to send you principal moments with J1 > J2 > J3; etc.
